# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô DTP NST GAS Library

## üì¶ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö

Library ‡∏ô‡∏µ‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢:
- ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö Authentication ‡πÅ‡∏•‡∏∞ Authorization ‡πÅ‡∏ö‡∏ö Token-based
- ‚úÖ CRUD Operations ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á (users, organizations, positions, ranks, ‡∏Ø‡∏•‡∏Ø)
- ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö Audit Logging ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏∏‡∏Å operation
- ‚úÖ Security: Password hashing, Token expiration, Validation
- ‚úÖ Access Control: Admin ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏ï‡πá‡∏°, User ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ org ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á

## üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á (Setup)

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Spreadsheet

1. ‡πÄ‡∏õ‡∏¥‡∏î Google Drive
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡πÉ‡∏´‡∏°‡πà ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô "DTP NST Database"
3. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å Spreadsheet ID ‡∏à‡∏≤‡∏Å URL
   ```
   URL: https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}/edit
   ‡πÄ‡∏ä‡πà‡∏ô: 1ABC...XYZ
   ```

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Apps Script Project

1. ‡∏à‡∏≤‡∏Å Spreadsheet: **Extensions > Apps Script**
2. ‡∏•‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î `function myFunction()` ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
3. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡πÇ‡∏î‡∏¢‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà **+ > Script file** ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
   - `Auth` (‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å Auth.gs)
   - `Authorization` (‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å Authorization.gs)
   - `CRUD` (‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å CRUD.gs)
   - `Utils` (‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å Utils.gs)
   - `Admin` (‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å Admin.gs)
4. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `Code.gs` (‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏£‡∏Å) ‡πÇ‡∏î‡∏¢‡∏•‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Code.gs

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Project Settings

1. ‡∏Ñ‡∏•‡∏¥‡∏Å **‚öôÔ∏è Project Settings** ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Show "appsscript.json" manifest file in editor**
3. ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Editor**
4. ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå **appsscript.json**
5. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å appsscript.json ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: Initialize Database

‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:

#### 4.1 ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Library
```javascript
function runSetup() {
  const spreadsheetId = '‡πÉ‡∏™‡πà SPREADSHEET_ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà';
  const result = setupLibrary(spreadsheetId);
  Logger.log(result);
}
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏£‡∏±‡∏ô:**
1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `runSetup` ‡∏à‡∏≤‡∏Å dropdown
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **Run**
3. ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡∏ñ‡∏≤‡∏°
4. ‡∏£‡∏≠‡∏à‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏ú‡∏•‡πÉ‡∏ô **Execution log**

#### 4.2 ‡∏™‡∏£‡πâ‡∏≤‡∏á Admin ‡πÅ‡∏£‡∏Å
```javascript
function runCreateAdmin() {
  const result = createInitialAdmin('admin', 'P@ssw0rd123', '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö');
  Logger.log(result);
}
```

**‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `runCreateAdmin`** 

‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å username ‡πÅ‡∏•‡∏∞ password ‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

#### 4.3 ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô Application ‡πÅ‡∏£‡∏Å
```javascript
function runRegisterApp() {
  const result = registerApplication(
    '‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£', 
    '‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£',
    ''
  );
  Logger.log(result);
}
```

**‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `runRegisterApp`**

**‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å `app_key` ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å log ‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Library

#### 4.4 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á
```javascript
function runTest() {
  const result = testLibrarySetup();
  Logger.log(result);
}
```

**‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `runTest`**

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ (‡∏ó‡∏∏‡∏Å test ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô PASS)

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: Deploy ‡πÄ‡∏õ‡πá‡∏ô Library

1. ‡∏Ñ‡∏•‡∏¥‡∏Å **Deploy > New deployment**
2. **Type:** ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Library**
3. **Description:** ‡πÉ‡∏™‡πà `DTP NST GAS Library v1.0`
4. **Access:** ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å `Anyone` (‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
5. ‡∏Ñ‡∏•‡∏¥‡∏Å **Deploy**
6. **‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **Script ID** ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô `1AbC...xYz`

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 6: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Maintenance (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)

‡∏™‡∏£‡πâ‡∏≤‡∏á Trigger ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥:

1. ‡∏Ñ‡∏•‡∏¥‡∏Å **‚è∞ Triggers** ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **Add Trigger** (‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤)
3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:
   - **Function:** `dailyMaintenance`
   - **Event source:** `Time-driven`
   - **Type:** `Day timer`
   - **Time:** ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å `2am to 3am` (‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°)
4. ‡∏Ñ‡∏•‡∏¥‡∏Å **Save**

---

## üì± ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Library ‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏û‡∏¥‡πà‡∏° Library

1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Apps Script Project ‡πÉ‡∏´‡∏°‡πà ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î project ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Libraries** (‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢) ‡∏Ñ‡∏•‡∏¥‡∏Å **+**
3. **Script ID:** ‡∏ß‡∏≤‡∏á Script ID ‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5
4. **Identifier:** ‡πÉ‡∏™‡πà `DTPNSTLib`
5. **Version:** ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å version ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
6. ‡∏Ñ‡∏•‡∏¥‡∏Å **Add**

### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö:

```javascript
function testLibraryConnection() {
  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
  const APP_KEY = 'app_key_‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà_4.3';
  const ADMIN_USER = 'admin';
  const ADMIN_PASS = 'P@ssw0rd123';
  
  // 1. ‡∏Ç‡∏≠ token
  Logger.log('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ç‡∏≠ token...');
  const tokenResult = DTPNSTLib.request_token({
    username: ADMIN_USER,
    password: ADMIN_PASS
  }, 'admin');
  
  if (!tokenResult.success) {
    Logger.log('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏≠ token ‡πÑ‡∏î‡πâ: ' + tokenResult.message);
    return;
  }
  
  Logger.log('‚úÖ ‡πÑ‡∏î‡πâ token ‡πÅ‡∏•‡πâ‡∏ß');
  Logger.log('Token: ' + tokenResult.token);
  Logger.log('‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏: ' + tokenResult.expiresAt);
  
  // 2. ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Library
  Logger.log('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...');
  const conn = DTPNSTLib.connect(APP_KEY, tokenResult.token);
  
  if (!conn.success) {
    Logger.log('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ: ' + conn.message);
    return;
  }
  
  Logger.log('‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
  
  // 3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  Logger.log('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• positions...');
  const positions = conn.read('positions', {});
  
  if (positions.success) {
    Logger.log('‚úÖ ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + positions.data.length + ' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
  } else {
    Logger.log('‚ùå ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + positions.message);
  }
  
  // 4. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
  const info = conn.info();
  Logger.log('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠:', info);
  
  Logger.log('===================');
  Logger.log('‚úÖ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå!');
}
```

‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `testLibraryConnection`

---

## üí° ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á

### ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£, ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á, ‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

```javascript
function createSampleData() {
  const APP_KEY = 'your_app_key';
  
  // ‡∏Ç‡∏≠ token
  const tokenResult = DTPNSTLib.request_token({
    username: 'admin',
    password: 'P@ssw0rd123'
  }, 'admin');
  
  const conn = DTPNSTLib.connect(APP_KEY, tokenResult.token);
  
  // 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£
  const org = conn.create('organizations', {
    hrms_id: 'HRMS001',
    dmz_id: 'DMZ001',
    org_name: '‡∏Å‡∏£‡∏°‡∏™‡∏°‡πÄ‡∏î‡πá‡∏à‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏ï‡∏≤‡∏Å‡∏™‡∏¥‡∏ô‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä',
    subdistrict: '‡πÅ‡∏Ç‡∏ß‡∏á‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô',
    district: '‡πÄ‡∏Ç‡∏ï‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢',
    province: '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£'
  });
  
  Logger.log('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£:', org);
  
  // 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
  const position = conn.create('positions', {
    name: '‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå',
    description: '‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå',
    level: 7
  });
  
  Logger.log('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:', position);
  
  // 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏¢‡∏®
  const rank = conn.create('ranks', {
    name: '‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©',
    abbreviation: '‡∏ä‡∏Å‡∏û.',
    level: 8
  });
  
  Logger.log('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏¢‡∏®:', rank);
  
  // 4. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
  const user = conn.create('users', {
    name: '‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ',
    id13: '1234567890123',
    password: 'User@123456',
    position_id: position.data.uuid,
    rank_id: rank.data.uuid,
    org_id: org.data.uuid
  });
  
  Logger.log('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:', user);
  
  Logger.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô');
}
```

### ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£

```javascript
function readOrgUsers() {
  const APP_KEY = 'your_app_key';
  
  // Login ‡πÄ‡∏õ‡πá‡∏ô User
  const tokenResult = DTPNSTLib.request_token({
    id13: '1234567890123',
    password: 'User@123456'
  }, 'user');
  
  if (!tokenResult.success) {
    Logger.log('Login ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
    return;
  }
  
  const conn = DTPNSTLib.connect(APP_KEY, tokenResult.token);
  
  // ‡∏≠‡πà‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô (‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞ filter ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)
  const users = conn.read('users', { active: true });
  
  if (users.success) {
    Logger.log('‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£:', users.data.length, '‡∏Ñ‡∏ô');
    
    users.data.forEach(function(user) {
      Logger.log('- ' + user.name + ' (' + user.id13 + ')');
    });
  }
}
```

### ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

```javascript
function updateUserData() {
  const APP_KEY = 'your_app_key';
  
  // Login ‡πÄ‡∏õ‡πá‡∏ô Admin
  const tokenResult = DTPNSTLib.request_token({
    username: 'admin',
    password: 'P@ssw0rd123'
  }, 'admin');
  
  const conn = DTPNSTLib.connect(APP_KEY, tokenResult.token);
  
  // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡πà‡∏≠‡∏ô
  const users = conn.read('users', { id13: '1234567890123' });
  
  if (users.data.length > 0) {
    const userId = users.data[0].uuid;
    
    // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    const result = conn.update('users', userId, {
      name: '‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç)',
      // ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÑ‡∏î‡πâ
    });
    
    Logger.log('‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', result);
  }
}
```

---

## üîê ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

### ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô Script Properties

‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô app_key ‡πÅ‡∏•‡∏∞ password ‡πÉ‡∏ô code:

```javascript
// ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (‡∏£‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
function setupSecureConfig() {
  const props = PropertiesService.getScriptProperties();
  props.setProperty('DTP_APP_KEY', 'your-real-app-key-here');
  props.setProperty('DTP_ADMIN_USER', 'admin');
  props.setProperty('DTP_ADMIN_PASS', 'P@ssw0rd123');
  
  Logger.log('‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
}

// ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
function secureLogin() {
  const props = PropertiesService.getScriptProperties();
  
  const tokenResult = DTPNSTLib.request_token({
    username: props.getProperty('DTP_ADMIN_USER'),
    password: props.getProperty('DTP_ADMIN_PASS')
  }, 'admin');
  
  if (tokenResult.success) {
    const conn = DTPNSTLib.connect(
      props.getProperty('DTP_APP_KEY'), 
      tokenResult.token
    );
    
    // ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô conn ‡∏ï‡πà‡∏≠‡πÑ‡∏õ...
  }
}
```

---

## üìä ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÅ‡∏•‡∏∞ Logs

### ‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏∞‡∏ö‡∏ö

```javascript
function viewStats() {
  // ‡∏£‡∏±‡∏ô‡∏à‡∏≤‡∏Å Library Project
  const stats = getLibraryStats();
  Logger.log('‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏∞‡∏ö‡∏ö:', stats);
}
```

### ‡∏î‡∏π Audit Logs

```javascript
function viewLogs() {
  const APP_KEY = 'your_app_key';
  
  const tokenResult = DTPNSTLib.request_token({
    username: 'admin',
    password: 'P@ssw0rd123'
  }, 'admin');
  
  const conn = DTPNSTLib.connect(APP_KEY, tokenResult.token);
  
  // ‡∏î‡∏π logs ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
  const logs = conn.read('logs', {});
  Logger.log('‡∏û‡∏ö logs:', logs.data.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
  
  // Filter logs ‡∏ï‡∏≤‡∏° action
  const createLogs = conn.read('logs', { action: 'CREATE' });
  Logger.log('CREATE operations:', createLogs.data.length);
}
```

---

## ‚ùì ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Spreadsheet not configured"
```javascript
// ‡∏£‡∏±‡∏ô setup ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
setupLibrary('your-spreadsheet-id');
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Invalid token"
```javascript
// ‡∏Ç‡∏≠ token ‡πÉ‡∏´‡∏°‡πà
const tokenResult = DTPNSTLib.request_token(credentials, userType);
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Access denied"
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÉ‡∏ä‡πâ user type ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (admin/user)
- Admin ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå CRUD ‡∏ó‡∏∏‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á
- User ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏Ñ‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô org ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: "Invalid app key"
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ app_key ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏î‡∏π app_key ‡∏à‡∏≤‡∏Å sheet "applications"
- ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á app ‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢ `registerApplication()`

---

## üìû ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô

‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Execution log
2. ‡∏£‡∏±‡∏ô `testLibrarySetup()` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á
3. ‡∏î‡∏π logs ‡πÉ‡∏ô spreadsheet

---

## ‚ú® ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

1. **Token Management**: Token ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô 24 ‡∏ä‡∏°. ‡∏Ñ‡∏ß‡∏£ request ‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥
2. **Password Security**: ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
3. **Backup**: ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• spreadsheet ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥
4. **Monitoring**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logs ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

---

**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô:** 1.0.0  
**‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:** ‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô 2568  
**‡∏ó‡∏µ‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤:** DTP NST Team
